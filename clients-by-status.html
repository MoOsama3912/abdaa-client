<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© - Abdaa Entalek</title>
    <!-- ØªØ¶Ù…ÙŠÙ† Tailwind CSS Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØµÙ…ÙŠÙ… Ø¹ØµØ±ÙŠ ÙˆÙ…ØªØ¬Ø§ÙˆØ¨ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- ğŸ›‘ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: var API_BASE = 'http://localhost:3000/api'; ğŸ›‘ -->
    <script src="config.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#3B82F6', // Ø§Ø²Ø±Ù‚
                        'secondary': '#10B981', // Ø§Ø®Ø¶Ø±
                        'danger': '#EF4444', // Ø§Ø­Ù…Ø±
                        'warning': '#F59E0B', // Ø§ØµÙØ±/Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
                    },
                    fontFamily: {
                        sans: ['Inter', 'Tahoma', 'Arial', 'sans-serif'], 
                    }
                }
            }
        }
    </script>

    <style>
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„ØªØ·Ø¨ÙŠÙ‚ RTL ÙˆØ¯Ù…Ø¬ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø®ØµØµØ© */
        body {
            font-family: 'Inter', Tahoma, Arial, sans-serif;
            background-color: #f4f7f9;
            direction: rtl;
        }

        /* ---------------------------------------------------------------------- */
        /* Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† @apply Ù„ØªØ¬Ù†Ø¨ Ø®Ø·Ø£ Ø§Ù„Ù…Ø­Ø±Ø± */
        /* ---------------------------------------------------------------------- */

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
        .btn {
            padding: 8px 16px; 
            border-radius: 8px; 
            font-weight: 700; 
            transition-property: all; 
            transition-duration: 200ms; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); /* shadow-md */
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 8px; 
        }
        .btn-primary {
            background-color: #3B82F6; /* primary */
            color: white;
        }
        .btn-primary:hover {
            background-color: #2563EB; /* hover:bg-blue-700 */
        }
        .btn-secondary {
            background-color: #E5E7EB; /* gray-200 */
            color: #374151; /* gray-800 */
            border: 1px solid #D1D5DB; /* border-gray-300 */
        }
        .btn-secondary:hover {
            background-color: #D1D5DB; /* hover:bg-gray-300 */
        }

        .page-header {
            background-color: white; 
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
            padding: 16px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            position: sticky; 
            top: 0; 
            z-index: 10;
        }

        .content-container {
            max-width: 1280px; /* max-w-7xl */
            margin-left: auto; 
            margin-right: auto; 
            padding: 16px;
        }

        .logo-container {
            /* Ø´Ø¹Ø§Ø± Ù†ØµÙŠ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ØµÙˆØ±Ø© */
            font-size: 24px; 
            font-weight: 800; /* font-extrabold */
            color: #3B82F6; /* primary */
        }

        /* Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ† */
        .delegates-section {
            background-color: white; 
            border-radius: 12px; /* rounded-xl */
            padding: 20px; 
            margin-bottom: 20px; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1); /* shadow-lg */
        }

        .delegates-grid {
            display: grid; 
            gap: 16px; 
            margin-top: 16px;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }

        .delegate-card {
            /* ØªØ¹Ø¯ÙŠÙ„ Ù†Ù…Ø· Ø§Ù„Ù€ a Ù„ÙŠØªØµØ±Ù ÙƒØ¨Ø·Ø§Ù‚Ø© */
            background-color: #F9FAFB; /* gray-50 */
            padding: 12px; 
            border-radius: 8px; 
            text-align: center; 
            cursor: pointer; 
            display: block; 
            text-decoration: none; 
            transition-property: background-color; 
            transition-duration: 150ms;
        }
        .delegate-card:hover {
            background-color: #F3F4F6; /* hover:bg-gray-100 */
        }

        .delegate-name {
            font-weight: 700; 
            color: #3B82F6; /* primary */
        }

        .delegate-stats {
            font-size: 14px; 
            color: #6B7280; /* gray-500 */
        }
        
        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ */
        .clients-grid {
            display: grid; 
            gap: 20px; 
            padding: 20px;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }

        .client-card {
            background-color: white; 
            border-radius: 8px; 
            padding: 16px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); /* shadow-md */
            transition-property: all; 
            transition-duration: 200ms; 
            position: relative;
        }
        .client-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05); /* hover:shadow-lg */
            transform: translateY(-2px); /* hover:-translate-y-0.5 */
        }
        
        .client-info h3 {
            font-size: 18px; 
            font-weight: 700; 
            margin-bottom: 8px; 
            color: #3B82F6; /* primary */
        }

        .client-info p {
            margin-top: 4px; 
            margin-bottom: 4px; 
            font-size: 14px; 
            color: #4B5563; /* gray-600 */
        }

        .client-actions {
            margin-top: 16px; 
            display: flex; 
            justify-content: flex-end;
        }

        .edit-btn {
            background-color: #3B82F6; /* primary */
            color: white; 
            padding-top: 8px; 
            padding-bottom: 8px; 
            padding-left: 16px; 
            padding-right: 16px; 
            border-radius: 6px; 
            font-size: 14px; 
            transition-property: background-color; 
            transition-duration: 200ms;
        }
        .edit-btn:hover {
            background-color: #2563EB; /* hover:bg-blue-700 */
        }

        .filters-container {
            display: flex; 
            flex-direction: column; 
            gap: 12px; 
            margin-bottom: 20px; 
            padding-left: 16px; 
            padding-right: 16px;
        }

        @media (min-width: 640px) { /* sm breakpoint */
            .filters-container {
                flex-direction: row;
            }
        }

        #search-input, #date-filter, #delegate-filter {
            padding: 10px; 
            border: 1px solid #D1D5DB; /* border-gray-300 */
            border-radius: 8px; 
            flex-grow: 1;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .data-management-container {
            display: flex; 
            flex-wrap: wrap; 
            justify-content: space-between; 
            align-items: center; 
            padding: 16px; 
            background-color: #F3F4F6; /* gray-100 */
            border-radius: 12px; /* rounded-xl */
            margin-left: 16px; 
            margin-right: 16px; 
            margin-bottom: 20px; 
            gap: 16px;
        }
        
        .export-buttons, .import-buttons {
            display: flex; 
            flex-direction: column; 
            gap: 12px;
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .export-buttons, .import-buttons {
                flex-direction: row;
            }
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (ÙƒÙ„Ø§Ø³Ø§Øª Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©) */
        .status-ÙÙŠ-Ø§Ù†ØªØ¸Ø§Ø±-Ø§ØªØµØ§Ù„ { border-right: 4px solid #3B82F6; } /* Ø§Ø²Ø±Ù‚ */
        .status-Ù…Ù‡ØªÙ…---Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© { border-right: 4px solid #10B981; } /* Ø§Ø®Ø¶Ø± */
        .status-ØºÙŠØ±-Ù…Ù‡ØªÙ… { border-right: 4px solid #EF4444; } /* Ø§Ø­Ù…Ø± */
        .status-Ù…Ù‚Ø§Ø¨Ù„Ø©-ÙÙŠ-Ø§Ù„Ù…ÙƒØªØ¨ { border-right: 4px solid #8B5CF6; } /* Ø¨Ù†ÙØ³Ø¬ÙŠ */
        .status-ØªØ¨Ø±Ø¹-Ù…Ø¤ÙƒØ¯ { border-right: 4px solid #059669; } /* Ø§Ø®Ø¶Ø± Ø¯Ø§ÙƒÙ† */
        .all-clients { border-right: 4px solid #3B82F6; }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ ÙˆØ§Ù„ØªØ­Ø°ÙŠØ± */
        .error-message {
            color: #EF4444; /* danger */
            text-align: center; 
            padding: 20px; 
            background-color: #FEE2E2; /* red-100 */
            border-radius: 8px; 
            margin: 20px; 
            border: 1px solid #FCA5A5; /* border-red-300 */
        }

        .no-results {
            text-align: center; 
            color: #6B7280; /* gray-500 */
            padding: 40px;
        }
        
        .note {
            font-size: 14px; 
            color: #374151; /* gray-700 */
            padding: 8px; 
            text-align: center;
        }
        
        /* Ø¥Ø®ÙØ§Ø¡ input Ø§Ù„Ø±ÙØ¹ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ */
        #upload-excel-input {
            display: none;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ */
        #custom-message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            background-color: white; 
            padding: 24px; 
            border-radius: 12px; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); /* shadow-2xl */
            border: 1px solid #E5E7EB; /* border-gray-200 */
            width: 91.666667%; /* w-11/12 */
            max-width: 448px; /* max-w-md */
            text-align: center;
            display: none;
        }
        #custom-message-box button {
            background-color: #3B82F6; /* primary */
            color: white; 
            margin-top: 16px; 
            padding-left: 16px; 
            padding-right: 16px; 
            padding-top: 8px; 
            padding-bottom: 8px; 
            border-radius: 8px; 
        }
        #custom-message-box button:hover {
            background-color: #2563EB; /* hover:bg-blue-700 */
        }
        
        /* ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
        @media print {
            .page-header, .delegates-section, .filters-container, .data-management-container, .client-actions, .back-button, .note, #filter-indicator {
                display: none !important;
            }
            .clients-grid {
                grid-template-columns: 1fr !important;
                box-shadow: none;
                border: none;
                padding: 0;
                margin: 0;
                display: block; 
            }
            .client-card {
                box-shadow: none;
                border: 1px solid #ccc;
                margin-bottom: 10px; 
                page-break-inside: avoid; 
            }
            .content-container { margin: 0; padding: 0; width: 100%; }
            h2#status-title { text-align: center; margin-bottom: 20px; display: block; }
        }
    </style>
</head>
<body>
    <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ (Ø¨Ø¯ÙŠÙ„ Ù„Ù€ alert) -->
    <div id="custom-message-box">
        <p id="message-text" class="text-gray-700"></p>
        <button id="message-ok-btn">Ø­Ø³Ù†Ø§Ù‹</button>
    </div>

    <header class="page-header">
        <div class="logo-container">
            Abdaa Entalek
        </div>
        <a href="clients-by-status.html" class="back-button btn btn-secondary">ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </header>

    <main class="content-container">
        <h2 id="status-title" class="text-3xl font-extrabold text-gray-800 mb-6 text-center">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
        
        <p class="note">
            ÙŠØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: <span id="api-base-display"></span>.
        </p>

        <!-- Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ† -->
        <div class="delegates-section">
            <h3 class="text-xl font-semibold mb-4 text-gray-700">Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</h3>
            <div id="delegates-list" class="delegates-grid">
                 <!-- Ù…Ø¤Ø´Ø± ØªØ­Ù…ÙŠÙ„ -->
                <p class="text-center text-gray-500 col-span-full" id="loading-delegates">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†...</p>
            </div>
        </div>

        <!-- ÙÙ„ØªØ±Ø© ÙˆØ¨Ø­Ø« -->
        <div class="filters-container">
            <input type="text" id="search-input" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" class="flex-1">
            <select id="delegate-filter" class="flex-1">
                <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</option>
            </select>
            <select id="date-filter" class="flex-1">
                <option value="all">ÙƒÙ„ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</option>
                <option value="today">Ø§Ù„ÙŠÙˆÙ…</option>
                <option value="week">Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
                <option value="month">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</option>
            </select>
        </div>
        
        <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ÙÙ„ØªØ±Ø© -->
        <div id="filter-indicator" class="note hidden"></div>
        
        <!-- Ù…Ù†Ø·Ù‚Ø© Ø£Ø²Ø±Ø§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
        <div class="data-management-container">
            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø© -->
            <div class="export-buttons">
                <button id="print-btn" class="btn btn-secondary"><i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙØ­Ø©</button>
                <button id="export-excel-btn" class="btn btn-primary"><i class="fas fa-file-excel"></i> ØªØ­Ù…ÙŠÙ„ Excel</button>
                <button id="export-pdf-btn" class="btn btn-primary"><i class="fas fa-file-pdf"></i> ØªØ­Ù…ÙŠÙ„ PDF</button>
            </div>
            
            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±ÙØ¹ ÙˆØ§Ù„Ù…Ø«Ø§Ù„ -->
            <div class="import-buttons">
                <label for="upload-excel-input" class="btn btn-primary">
                    <i class="fas fa-file-upload"></i> Ø±ÙØ¹ Ù…Ù„Ù Excel
                </label>
                <input type="file" id="upload-excel-input" accept=".xlsx, .xls">
                
                <button id="download-example-btn" class="btn btn-secondary">
                    <i class="fas fa-file-download"></i> ØªØ­Ù…ÙŠÙ„ Ù…Ø«Ø§Ù„
                </button>
            </div>
        </div>


        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ -->
        <div id="clients-list" class="clients-grid">
            <p class="text-center text-xl text-gray-500 col-span-full" id="loading-clients">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡...</p>
        </div>
    </main>

    <script>
        // ----------------------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø®ØµØµ (Ø¨Ø¯ÙŠÙ„ Ù„Ù€ alert)
        // ----------------------------------------------------------------
        function customAlert(message) {
            const box = document.getElementById('custom-message-box');
            const text = document.getElementById('message-text');
            const okBtn = document.getElementById('message-ok-btn');

            text.textContent = message;
            box.style.display = 'block';

            return new Promise(resolve => {
                okBtn.onclick = () => {
                    box.style.display = 'none';
                    resolve();
                };
            });
        }
        
        // ----------------------------------------------------------------
        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ (Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù„Ø¹Ø¯Ù… ØªÙˆÙØ± ØµÙØ­Ø© ØªØ¹Ø¯ÙŠÙ„ Ø­Ù‚ÙŠÙ‚ÙŠØ©)
        // ----------------------------------------------------------------
        function editClient(id) {
            customAlert(`ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ. (${id} - ÙŠØªØ·Ù„Ø¨ ØµÙØ­Ø© edit-client.html)`);
        }
        
        // ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ø¯Ø§Ù„Ø© Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹
        window.editClient = editClient;
        
        // ----------------------------------------------------------------
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… API Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Ù…Ø¹ Exponential Backoff)
        // ----------------------------------------------------------------
        async function fetchWithRetry(url, retries = 3, delay = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø®Ø·Ø£ 404 Ø£Ùˆ ØºÙŠØ±Ù‡ØŒ Ø§Ø±Ù…Ù Ø§Ù„Ø®Ø·Ø£ Ù…Ø¨Ø§Ø´Ø±Ø©
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return await response.json();
                } catch (error) {
                    if (i < retries - 1) {
                        // console.warn(`Fetch failed for ${url}. Retrying in ${delay / 1000}s...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2; // Exponential backoff
                    } else {
                        // Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (ÙŠØ´Ù…Ù„ Ø®Ø·Ø£ CORS Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø­Ù„Ù‡ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±)
                        throw new Error(`Failed to fetch (${error.message}). (after multiple retries: ${error.message}). ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙˆÙ…Ù† ØµØ­Ø© Ù…Ø³Ø§Ø± API (${url}).`);
                    }
                }
            }
        }
        
        async function fetchClientData() {
            // ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ¹Ø±ÙŠÙ API_BASE (ØªÙ… ØªØ¹Ø±ÙŠÙÙ‡ ÙÙŠ config.js)
            // Ù†Ø³ØªØ®Ø¯Ù… window.API_BASE Ù„Ø£Ù†Ù†Ø§ Ù†Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø£Ù† config.js Ù‚Ø¯ Ù†Ø´Ø±Ù‡
            if (typeof window.API_BASE === 'undefined') {
                throw new Error("API_BASE is not defined. Please ensure config.js is loaded correctly and defines 'var API_BASE'.");
            }
            
            try {
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ† Ø¨Ø§Ù„ØªÙˆØ§Ø²ÙŠ
                const [clients, delegates] = await Promise.all([
                    fetchWithRetry(`${window.API_BASE}/clients`),
                    fetchWithRetry(`${window.API_BASE}/delegates`)
                ]);

                return { clients, delegates };
            } catch (error) {
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø®Ø·Ø£ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙÙŠ DOM
                throw error;
            }
        }

        // ----------------------------------------------------------------
        // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª
        // ----------------------------------------------------------------
        
        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ ØµÙŠØºØ© Slug (Ù„Ù€ CSS Class)
        function toStatusSlug(status) {
            if (!status) return 'all-clients';
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø£Ø­Ø±Ù ØºÙŠØ± Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ© ÙˆØ§Ù„Ø±Ù‚Ù…ÙŠØ©ØŒ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ø´Ø±Ø·Ø§Øª Ø¨Ø§Ù„Ø´Ø±Ø·Ø© Ø§Ù„ÙˆØ§ØµÙ„Ø©
            return status.replace(/[^\u0600-\u06FF\w\s-]/g, '').replace(/\s+/g, '-').toLowerCase();
        }

        document.addEventListener('DOMContentLoaded', async function() {
            const clientsList = document.getElementById('clients-list');
            const searchInput = document.getElementById('search-input');
            const dateFilter = document.getElementById('date-filter');
            const delegateFilter = document.getElementById('delegate-filter');
            const statusTitleEl = document.getElementById('status-title'); 
            const delegatesListEl = document.getElementById('delegates-list');
            const filterIndicatorContainer = document.getElementById('filter-indicator');
            const apiBaseDisplayEl = document.getElementById('api-base-display');

            // Ø¹Ø±Ø¶ Ø¹Ù†ÙˆØ§Ù† API ÙÙŠ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©
            if (typeof window.API_BASE !== 'undefined') {
                 apiBaseDisplayEl.textContent = window.API_BASE;
            }

            const loadingClients = document.getElementById('loading-clients');
            const loadingDelegates = document.getElementById('loading-delegates');

            const urlParams = new URLSearchParams(window.location.search);
            const statusParam = urlParams.get('status');
            const delegateParam = urlParams.get('delegate');

            let allClients = [];
            // baseFilteredClients: Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø³ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø¹Ø¯ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø§Ù„Ø­Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù€ URL ÙÙ‚Ø·)
            let baseFilteredClients = []; 
            let allDelegates = [];
            
            // ----------------------------------------------------------------
            // 1. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
            // ----------------------------------------------------------------
            function showFilterIndicator(name) {
                if (!filterIndicatorContainer) return;
                
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ÙÙ„ØªØ± Ù…Ù†Ø¯ÙˆØ¨ Ù…Ø·Ø¨Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ù€ URL
                if (!name || delegateFilter.value === 'all') { 
                    filterIndicatorContainer.classList.add('hidden');
                    return;
                }
                
                filterIndicatorContainer.classList.remove('hidden');
                filterIndicatorContainer.innerHTML = `
                    <strong>ÙÙ„ØªØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…ÙØ·Ø¨Ù‚:</strong> ${name}
                    <button id="clear-delegate-filter" class="edit-btn" style="margin-right:12px;padding:6px 10px;font-size:0.9em;background:#EF4444">Ù…Ø³Ø­ ÙÙ„ØªØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</button>
                `;
                // Ø±Ø¨Ø· Ø­Ø¯Ø« Ù…Ø³Ø­ Ø§Ù„ÙÙ„ØªØ±
                document.getElementById('clear-delegate-filter').addEventListener('click', () => {
                    urlParams.delete('delegate');
                    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© Ù†Ø¸ÙŠÙØ© ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØµÙÙŠØ©
                    window.location.href = window.location.pathname + (urlParams.toString() ? ('?' + urlParams.toString()) : '');
                });
            }

            function displayClients(clients) {
                loadingClients.classList.add('hidden');
                
                if (clients.length === 0) {
                    clientsList.innerHTML = '<p class="no-results">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ ÙŠØ·Ø§Ø¨Ù‚ÙˆÙ† Ø´Ø±ÙˆØ· Ø§Ù„ØªØµÙÙŠØ©.</p>';
                    return;
                }

                clientsList.innerHTML = clients.map(client => {
                    const delegateObj = allDelegates.find(d => d._id === client.delegate);
                    const delegateName = delegateObj ? delegateObj.name : (client.delegate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
                    
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ ØµÙŠØºØ© slug CSS
                    const statusSlug = toStatusSlug(client.status);

                    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
                    const clientDate = client.createdAt ? new Date(client.createdAt).toLocaleDateString('ar-EG', { year: 'numeric', month: 'short', day: 'numeric' }) : 'ØºÙŠØ± Ù…ØªÙˆÙØ±';

                    return `
                        <div class="client-card status-${statusSlug}">
                            <div class="client-info">
                                <h3>${client.name}</h3>
                                <p class="status"><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${client.status || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</p>
                                <p class="delegate"><strong>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:</strong> ${delegateName}</p>
                                <p class="phone">ğŸ“± ${client.phone || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</p>
                                <p class="date">ğŸ“… ${clientDate}</p>
                                ${client.notes ? `<p class="notes">ğŸ“ ${client.notes.substring(0, 50)}${client.notes.length > 50 ? '...' : ''}</p>` : ''}
                            </div>
                            <div class="client-actions">
                                <button onclick="editClient('${client._id}')" class="edit-btn">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // ----------------------------------------------------------------
            // 2. Ø¯Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (ØªØ¬Ù…Ø¹ Ø§Ù„ÙƒÙ„)
            // ----------------------------------------------------------------
            function applyAllFilters() {
                const searchTerm = searchInput.value.toLowerCase();
                const dateValue = dateFilter.value;
                const selectedDelegate = delegateFilter.value; // Ù‚ÙŠÙ…Ø© Ø§Ù„ÙÙ„ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
                
                // Ù†Ø¨Ø¯Ø£ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªØµÙÙŠØªÙ‡Ø§ Ø¨Ø§Ù„Ø­Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù€ URL ÙÙ‚Ø·
                let filtered = baseFilteredClients; 

                // 1. ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø«
                if (searchTerm) {
                    filtered = filtered.filter(client => 
                        (client.name && client.name.toLowerCase().includes(searchTerm)) ||
                        (client.phone && client.phone.includes(searchTerm))
                    );
                }

                // 2. ÙÙ„ØªØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©)
                if (selectedDelegate !== 'all') {
                    filtered = filtered.filter(client => client.delegate === selectedDelegate);
                }
                
                // 3. ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®
                if (dateValue !== 'all') {
                    const now = new Date();
                    // ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„ÙŠÙˆÙ… Ø¨ØªÙˆÙ‚ÙŠØª Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„ Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨
                    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate()); 
                    
                    filtered = filtered.filter(client => {
                        const createdAt = new Date(client.createdAt);
                        let filterDate = new Date(today.getTime()); // Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„ÙŠÙˆÙ…

                        switch(dateValue) {
                            case 'today': 
                                // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨Ø¹Ø¯ Ø£Ùˆ ÙŠØ³Ø§ÙˆÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙŠÙˆÙ…
                                return createdAt >= filterDate;
                            case 'week': 
                                // Ø£Ø³Ø¨ÙˆØ¹ Ù…Ø¶Ù‰
                                filterDate.setDate(filterDate.getDate() - 7);
                                return createdAt >= filterDate;
                            case 'month': 
                                // Ø´Ù‡Ø± Ù…Ø¶Ù‰
                                filterDate.setMonth(filterDate.getMonth() - 1);
                                return createdAt >= filterDate;
                            default: 
                                return true;
                        }
                    });
                }
                
                displayClients(filtered);
            }

            // ----------------------------------------------------------------
            // 3. Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØªÙ‡ÙŠØ¦Ø©
            // ----------------------------------------------------------------
            try {
                // Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù€ API
                const data = await fetchClientData(); 
                allClients = data.clients;
                allDelegates = data.delegates;
                
                // Ù†Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡
                baseFilteredClients = [...allClients]; 

                // ØªØ¹Ø¨Ø¦Ø© ÙÙ„ØªØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨
                if (delegateFilter) {
                    delegateFilter.innerHTML = `
                        <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</option>
                        ${allDelegates.map(d => `<option value="${d._id}">${d.name}</option>`).join('')}
                    `;
                }
                
                // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†
                loadingDelegates.classList.add('hidden');

                // Ø¹Ø±Ø¶ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†
                if (delegatesListEl) {
                    delegatesListEl.innerHTML = allDelegates.map(delegate => {
                        // Ø§Ø³ØªØ®Ø¯Ø§Ù… count Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªÙˆÙØ±Ø§Ù‹ Ù…Ù† Ø§Ù„Ù€ API)
                        const count = delegate.clientsCount || 0; 
                        
                        // Ù†Ø³ØªØ®Ø¯Ù… statusParam ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ØŒ ÙˆØ¥Ù„Ø§ Ù„Ø§ Ù†Ø±Ø³Ù„Ù‡
                        const statusQuery = statusParam ? `&status=${statusParam}` : '';

                        return `
                            <a href="clients-by-status.html?delegate=${delegate._id}${statusQuery}" class="delegate-card">
                                <div class="delegate-name">${delegate.name}</div>
                                <div class="delegate-stats">Ø¹Ù…Ù„Ø§Ø¡ (${count})</div>
                            </a>
                        `;
                    }).join('');
                }

                // ----------------------------------------------------------------
                // 4. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø£ÙˆÙ„ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù€ URL (Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ù…Ù†Ø¯ÙˆØ¨)
                // ----------------------------------------------------------------
                let delegateNameForTitle = '';

                if (statusParam && statusParam !== 'all') {
                    // Ø§Ù„ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„Ø­Ø§Ù„Ø© ÙÙ‚Ø· Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© baseFilteredClients
                    baseFilteredClients = baseFilteredClients.filter(client => 
                        toStatusSlug(client.status) === toStatusSlug(statusParam)
                    );
                    statusTitleEl.textContent = `Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - ${statusParam.replace(/-/g, ' ')}`;
                    document.title = `Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - ${statusParam.replace(/-/g, ' ')} - Abdaa Entalek`;
                } else {
                    statusTitleEl.textContent = `ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡`;
                }

                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ÙÙ„ØªØ± Ù…Ù†Ø¯ÙˆØ¨ ÙÙŠ Ø§Ù„Ù€ URLØŒ Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù…Ø¤Ø´Ø±
                if (delegateParam && delegateParam !== 'all') {
                    const matchedDelegate = allDelegates.find(d => d._id === delegateParam);
                    
                    if (matchedDelegate) {
                        delegateFilter.value = matchedDelegate._id;
                        delegateNameForTitle = matchedDelegate.name;
                    }
                    // Ø¹Ø±Ø¶ Ù…Ø¤Ø´Ø± Ø§Ù„ÙÙ„ØªØ± Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
                    showFilterIndicator(delegateNameForTitle || delegateParam);
                }

                // ----------------------------------------------------------------
                // 5. Ø±Ø¨Ø· Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
                // ----------------------------------------------------------------
                
                // Ø±Ø¨Ø· Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
                searchInput.addEventListener('input', applyAllFilters);
                dateFilter.addEventListener('change', applyAllFilters);
                delegateFilter.addEventListener('change', applyAllFilters); 
                

                // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø±Ø³Ø§Ø¦Ù„ ØªÙˆØ¶ÙŠØ­ÙŠØ© Ù„Ø¹Ø¯Ù… ØªÙˆÙØ± ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù€ API)
                document.getElementById('print-btn').addEventListener('click', () => { window.print(); });
                
                document.getElementById('export-excel-btn').addEventListener('click', () => {
                    customAlert('ÙˆØ¸ÙŠÙØ© ØªØ­Ù…ÙŠÙ„ Excel (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±) - ØªØªØ·Ù„Ø¨ Ù…ÙƒØªØ¨Ø© Ø®Ø§Ø±Ø¬ÙŠØ© Ù„ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.');
                });

                document.getElementById('export-pdf-btn').addEventListener('click', () => {
                    customAlert('ÙˆØ¸ÙŠÙØ© ØªØ­Ù…ÙŠÙ„ PDF (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±) - ØªØªØ·Ù„Ø¨ Ù…ÙƒØªØ¨Ø© Ø®Ø§Ø±Ø¬ÙŠØ© Ù„ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.');
                });

                document.getElementById('download-example-btn').addEventListener('click', () => {
                    customAlert('ÙˆØ¸ÙŠÙØ© ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù…Ø«Ø§Ù„ (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±) - ÙŠØ¬Ø¨ ØªÙˆÙÙŠØ± Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù…Ø³Ø§Ø± /templates/example.xlsx.');
                });

                document.getElementById('upload-excel-input').addEventListener('change', async (event) => {
                    const file = event.target.files[0];
                    if (!file) return;
                    
                    customAlert(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù: ${file.name}. ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø±ÙØ¹ (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±) - ØªØªØ·Ù„Ø¨ Ø³ÙŠØ±ÙØ± Backend. Ù„Ù† ÙŠØªÙ… Ø§Ù„Ø±ÙØ¹ ÙØ¹Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ.`);
                    event.target.value = ''; // Ù…Ø³Ø­ Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                });
                
                // Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ÙŠØ·Ø¨Ù‚ ÙƒÙ„ Ø§Ù„ÙÙ„Ø§ØªØ±)
                applyAllFilters();

            } catch (err) {
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø®Ø·Ø£ ÙˆØ¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø¶Ø­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                console.error('Ø®Ø·Ø£ ÙØ§Ø¯Ø­ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', err);
                loadingClients.classList.add('hidden');
                loadingDelegates.classList.add('hidden');
                clientsList.innerHTML = `<p class="error-message">
                    Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${err.message}. 
                    
                    <br>
                    ÙŠØ±Ø¬Ù‰ **ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ù config.js** Ù„ØªØ¹Ø±ÙŠÙ ` ;API_BASE = 'http://localhost:3000/api';` (Ù„Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ù„ÙŠ) ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† **ØªØ´ØºÙŠÙ„ Ø³ÙŠØ±ÙØ± Node.js** Ø£ÙˆÙ„Ø§Ù‹.
                </p>`;
            }
        });
    </script>
</body>
</html>